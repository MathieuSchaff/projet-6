(()=>{"use strict";let e=new Request("data.json",{method:"GET",headers:{Accept:"application/json","Content-type":"application/json"},mode:"cors",cache:"default"});const t=async()=>{let t=await fetch(e);return await t.json()};async function n(){let e=await(async()=>{let{photographers:e}=await t();return e})(),n=new URLSearchParams(window.location.search);for(let t=0;t<e.length;t++)if(e[t].id==n.get("id"))return e[t]}async function o(){let e=await(async()=>{let{media:e}=await t();return e})(),n=new URLSearchParams(window.location.search),o=[];return e.forEach((e=>{e.photographerId==n.get("id")&&o.push(e)})),o}const a=e=>{if("string"==typeof e)return document.createTextNode(e);const t=document.createElement(e.tag);return e.props&&Object.entries(e.props).forEach((([e,n])=>{t[e]=n})),e.children&&e.children.forEach((e=>{t.appendChild(a(e))})),t},r=(e,t,n)=>({tag:e,props:t,children:n}),l=(e,t,n)=>{if(!t&&""!==t)return e.remove();if("string"==typeof n||"string"==typeof t){if(n!==t)return e.replaceWith(a(t))}else{if(n?.tag!==t.tag)return e.replaceWith(a(t));if(n){for(const o in n.props)if(n.props[o]===t.props[o])return e.replaceWith(a(t));for(let o=e.childNodes.length-1;o>=0;o--)l(e.childNodes[o],t.children[o],n.children[o])}}};function i(e){return r("a",{className:"header__logo",href:"index.html"},[e])}function c(){return r("img",{src:"./logo/logo.svg",alt:"Fisheye page d'acceuil",tabindex:"0"})}function s(e){let t=e[0].toUpperCase()+e.slice(1);return r("button",{id:`${e}`,className:"nav--button",type:"button",tabindex:"0",role:"menuitem",value:`${e}`},[`#${t}`])}function d(e,t){return r("div",{className:"photographer-main"},[e,t])}function u(e,t,n,o){return r("div",{className:"photographer-profile"},[e,t,n,o])}function m(e){return r("p",{className:"photographer-profile--philosophy"},[e])}function p(e){return r("div",{className:"img"},[e])}function h(e){return r("div",{className:"containerTags"},e)}function f(e,t){return r("div",{className:"formData"},[e,t])}function y(e,t){return r("label",{for:`${e}`},[`${t}`])}function v(e,t,n,o){return r("input",{className:`text-control ${o}`,type:`${e}`,id:`${t}`,name:`${t}`,ariaLabel:`${n}`,required:"true"},void 0)}async function g(){let e=await n();const t=(await o()).map((e=>e.likes)).reduce(((e,t)=>e+t),0);let a=document.querySelector(".totalLikes--number");a.innerHTML=`${t}`,document.querySelector(".salaire--journalier").innerHTML=`${e.price}€ / jour`;let r=document.querySelectorAll(".heart");console.log(r),r.forEach((e=>{e.addEventListener("click",(()=>{console.log(typeof Number(a.textContent)),a.textContent=`${Number(a.textContent)+1}`,e.firstElementChild.textContent=`${Number(e.firstElementChild.textContent)+1}`}))}))}function b(e,t){return r("figure",void 0,[e,t])}function w(e,t){return r("figcaption",void 0,[e,t])}function x(e){return r("p",{className:"textfig"},[e])}function L(e){return r("button",{className:"heart",tabIndex:"0",ariaLabel:`Nombre de likes ${e}`},[r("div",{className:"likes"},[`${e}`]),r("i",{className:"fas fa-heart"})])}const S=async e=>{let t=await n(),a=await(async e=>{let t=await o();switch(e){case"Date":t.forEach((e=>{let t=e.date.split("-").join(" "),n=new Date(t);e.date=n})),t.sort(((e,t)=>t.date-e.date));break;default:t.sort(((e,t)=>t.likes-e.likes));break;case"Titre":t.sort((function(e,t){return e.title.localeCompare(t.title)}))}return t})(e);return r("section",{className:"sectioncontainer"},a.map((e=>{return Object.keys(e).includes("image")?b((o=t.name,a=e.image,l=e.altTextMedia,r("img",{src:`./FishEyePhotos/Sample Photos/${o}/${a.replace(".jpg","")}_resultat.jpg`,className:"img-card",alt:`${l}`,tabIndex:"0"},void 0)),w(x(e.title),L(e.likes))):b((n=function(e,t,n){return r("source",{src:`./FishEyePhotos/Sample Photos/${e}/${t}`,className:"img-card",type:"video/mp4",alt:`${n}`},void 0)}(t.name,e.video,e.altTextMedia),r("video",{className:"img-card",muted:!0,controls:!0},[n])),w(x(e.title),L(e.likes)));var n,o,a,l})))},k=()=>{const e=[...document.querySelectorAll(".img-card")],t=[...document.querySelectorAll("img.img-card, source")].map((e=>`${e.src}`));e.forEach((e=>{e.addEventListener("click",(n=>{let o=document.createElement("div");function a(e){console.log("clické sur close"),o.classList.add("fadeOut"),window.setTimeout((()=>{o.remove(),o=null}),500)}function r(){n.preventDefault();let a=o.querySelector("img, video");a.currentSrc.endsWith("mp4")&&(a=a.querySelector("source"));let r=t.findIndex((e=>e===a.src));r+=1,r>=t.length&&(r=0),t[r].endsWith("mp4")?(console.log("ceci est une vidéo"),o.querySelector(".lightbox__container").innerHTML=`\n          <video class="img-card" muted  controls>\n          <source src="${t[r]}" type="video/mp4" alt="${e.alt}">\n  \n          </video>\n          `):o.querySelector(".lightbox__container").innerHTML=`\n          <img src="${t[r]}" alt="${e.alt}">\n          `}function l(){n.preventDefault();let a=o.querySelector("img, video");a.currentSrc.endsWith("mp4")&&(a=a.querySelector("source"));let r=t.findIndex((e=>e===a.src));r-=1,r<0&&(r=t.length-1),t[r].endsWith("mp4")?(console.log("ceci est une vidéo"),o.querySelector(".lightbox__container").innerHTML=`\n          <video class="img-card" muted  controls>\n          <source src="${t[r]}" type="video/mp4" alt="${e.alt}">\n  \n          </video>\n          `):o.querySelector(".lightbox__container").innerHTML=`\n          <img src="${t[r]}" alt="${e.alt}">\n          `}o.classList.add("lightbox"),"IMG"==e.nodeName?o.innerHTML=`\n        <button class="lightbox__close" tab-index="1">Fermer</button>\n          <button class="lightbox__next" tab-index="1">Suivant</button>\n          <button class="lightbox__prev"tab-index="1" >Précédent</button>\n  \n          <div class="lightbox__container">\n           <img src="${e.src}" alt="${e.alt}" tab-index="1">\n          </div>\n        `:(e.pause(),o.innerHTML=`\n          <button class="lightbox__close">Fermer</button>\n          <button class="lightbox__next">Suivant</button>\n          <button class="lightbox__prev">Précédent</button>\n  \n          <div class="lightbox__container">\n          <video class="img-card" muted  controls>\n          <source src="${e.currentSrc}" type="video/mp4" alt="${e.alt}">\n  \n          </video>\n          </div>\n        `),o.querySelector(".lightbox__close").addEventListener("click",a),o.querySelector(".lightbox__prev").addEventListener("click",l),o.querySelector(".lightbox__next").addEventListener("click",r),window.addEventListener("keydown",(function(e){null!==o&&"Escape"===e.key&&a(),null!==o&&"ArrowLeft"===e.key&&l(),null!==o&&"ArrowRight"===e.key&&r(),null!==o&&"Tab"===e.key&&function(e){e.preventDefault();let t=Array.from(document.querySelectorAll(".lightbox__prev, .lightbox__next, .lightbox__close, .lightbox__container img"));console.log(t);let n=t.findIndex((e=>e===document.querySelector(":focus")));console.log(n),!0===e.shiftKey?n--:n++,n>=t.length-1&&(n=0),n<0&&(n=t.length-1),t[n].focus()}(e)})),document.body.appendChild(o),document.querySelector(".lightbox__close").focus()}))}))};async function E(e){let n,{photographers:o}=await t();if(null==e||""==e.toLocaleString())return o;{let t=[],a=[];n=e;for(const[e,a]of n.entries())for(let n=0;n<o.length;n++)o[n].tags.includes(e)&&t.push(o[n]);return a=[...t.reduce(((e,t)=>e.set(t.id,t)),new Map).values()],a}}function N(e){return r("h2",{className:"main__name"},[e])}function _(e){return r("div",{className:"tags"},e)}async function q(e){let t=await e;return r("main",{id:"articles"},t.map((e=>{let t=e.tags.map((e=>{return r("button",{className:"nav--button tagTri",type:"button",value:`${t=e}`},[`#${t}`]);var t}));return r("article",{className:"main"},[r("a",{href:`http://127.0.0.1:5500/index.html?id=${e.id}`,className:"main__link",onclick:"mafonction(this)"},[(i=e.portrait,c=e.name,r("img",{className:"main__photo",src:`./FishEyePhotos/Sample Photos/Photographers ID Photos/${i}`,alt:`Portrait du photographe ${c}`},void 0)),N(e.name)]),r("p",{className:"main__paragraph"},[(a=e.city,l=e.country,r("p",{className:"main__location"},[`${a}, ${l}`])),(o=e.tagline,r("p",{className:"main__philosophy"},[o])),(n=e.price,r("p",{className:"main__tarif"},[`${n} €`])),_(t)])]);var n,o,a,l,i,c})))}let $,A;const T=async e=>{let t=new URLSearchParams(window.location.search),n=new URLSearchParams(window.location.search);t.has(e)?t.delete(e):null!==e&&t.append(e,!0),$=await q(E(n)),A=await q(E(t));let o=t.toLocaleString();history.pushState({},null,`?${o}`);let a=document.getElementById("articles");l(a,A,$);const r=document.querySelectorAll("button.nav--button");for(let e=0;e<r.length;e++)for(const[n,o]of t.entries())console.log(n),r[e].value==n?(console.log(`${r} + key = ${n}`),r[e].classList.add("focused")):r[e].classList.contains("focused")&&r[e].value!=n&&r[e].classList.remove("focused");const i=document.querySelectorAll("nav button.nav--button");let c=[];for(var s of t.keys())c.push(s);for(let e=0;e<i.length;e++)i[e].classList.contains("focused")&&i[e].classList.remove("focused");for(let e=0;e<i.length;e++)c.includes(i[e].value)&&i[e].classList.add("focused");r.forEach((e=>{e.addEventListener("click",(()=>{T(e.value)}))}))};async function P(){let e=document.querySelector(".wrapper");e.innerHTML="",async function(){return r("header",{className:"header"},[i(c()),r("nav",{className:"header__nav",ariaLabel:"trier par catégorie",tabindex:"0",role:"navigation"},[s("portrait"),s("art"),s("fashion"),s("architecture"),s("travel"),s("sport"),s("animals"),s("events")]),r("h1",{className:"header__title",tabindex:"0"},["Nos photographes"])])}().then((t=>{let n=a(t);e.appendChild(n)})),async function(){return r("a",{href:"#",alt:"redirect to main content",className:"redirect",ariaModal:"true",ariaLabel:"modal is loaded",role:"dialog",ariaHidden:"true",ariaExpanded:"false"},["Passer au contenu"])}().then((e=>{let t=a(e);document.body.insertAdjacentElement("afterbegin",t);const n=document.querySelector(".redirect");window.addEventListener("scroll",(()=>{window.scrollY>0?(n.style.display="flex",n.setAttribute("tabindex",1),n.setAttribute("aria-expanded","true")):(n.style.display="none",n.setAttribute("tabindex",-1),n.setAttribute("aria-expanded","false"))}))}));let t=new URLSearchParams(window.location.search),n=await q(E(t)),o=a(n);e.insertAdjacentElement("beforeEnd",o);const l=document.querySelectorAll("button.nav--button"),d=document.querySelectorAll("nav button.nav--button");let u=[];for(var m of t.keys())u.push(m);for(let e=0;e<d.length;e++)u.includes(d[e].value)&&d[e].classList.add("focused");console.log(u),l.forEach((e=>{e.addEventListener("click",(()=>{T(e.value)}))}))}""===window.location.search||window.location.search.endsWith("true")?P():window.location.search.startsWith("?id")?async function(){document.querySelector(".wrapper").innerHTML="",async function(){return r("header",void 0,[i(c())])}().then((e=>{let t=a(e);document.querySelector(".wrapper").insertAdjacentElement("afterbegin",t)})),async function(){let e=await n(),t=e.tags.map((e=>{return r("a",{className:"nav--button button--photographer",href:`index.html?${t=e}=true`,value:`${t}`},[`#${t}`,r("span",{className:"sr-only"},[`#${t}`])]);var t}));var o,a,l,i;return r("article",{className:"photographer-header"},[d(u((i=e.name,r("h1",{className:"photographer-profile--name"},[i])),(a=e.city,l=e.country,r("p",{className:"photographer-profile--location"},[` ${a}, ${l}`])),m(e.tagline),h(t)),r("button",{className:"contact-me"},["Contactez-moi"])),p((o=e.portrait,r("img",{className:"photographer-profile--photo",alt:"Photo portrait du photographe",src:`./FishEyePhotos/Sample Photos/Photographers ID Photos/${o}`},void 0)))])}().then((e=>{console.log("jetnre dabord ans le card");let t=a(e);document.querySelector(".wrapper").insertAdjacentElement("beforeend",t)})).then((()=>{let e=a(r("aside",{className:"contact-modal",role:"dialog",ariaModal:"false",ariaHidden:"true",ariaLabelledby:"contact__title",style:"display: none"},[r("div",{className:"modal--wrapper"},[r("header",{id:"form-header"},[r("h1",{id:"contact__title"},["Contactez moi",r("span",{className:"contact-name"},["Mimi Keel"])]),r("a",{href:"",id:"closeButton",className:"close",ariaLabel:"Fermer le formulaire"},[r("img",{src:"logo/Vector (2).svg",alt:"cross"},void 0)])]),r("form",{id:"form",name:"fisheye"},[f(y("first","Prénom"),v("text","first","prénom")),f(y("last","Nom"),v("text","last","nom de famille")),f(y("email","E-mail"),v("email","email","email")),f(y("comment","Votre message"),("comment","commentaire","comment",r("textarea",{className:"text-control comment",id:"comment",ariaLabel:"commentaire",required:"true"},void 0))),r("input",{className:"submit",value:"Envoyer",ariaLabel:"send",type:"submit"},void 0)])])]));document.querySelector(".wrapper").appendChild(e)})).then((()=>{(async()=>{let e=await n();document.querySelector(".contact-name").innerHTML=`${e.name}`;const t=document.getElementById("closeButton");let o=null;const a=document.querySelector(".contact-me"),r="button, a, input, textarea";let l=[];const i=function(e){e.preventDefault(),window.setTimeout((function(){o.style.display="none"}),300),o.setAttribute("aria-hidden",!0),o.removeAttribute("aria-modal"),t.removeEventListener("click",i),o.removeEventListener("click",i),document.querySelector(".modal--wrapper").removeEventListener("click",c),document.querySelector(".contact-me").style.zIndex="1",document.querySelector("#Order-wrapper").style.zIndex="20",a.focus()};a.addEventListener("click",(function(e){e.preventDefault(),o=document.querySelector(".contact-modal"),l=Array.from(o.querySelectorAll(r)),l[0].focus(),console.log(o.querySelectorAll(r)),console.log(l),o.style.display=null,o.removeAttribute("aria-hidden"),o.setAttribute("aria-modal",!0),t.addEventListener("click",i),o.addEventListener("click",i),document.querySelector(".modal--wrapper").addEventListener("click",c),console.log(document.querySelector(".contact-me").style.zIndex),document.querySelector(".contact-me").style.zIndex="-1",console.log(document.querySelector(".Order-wrapper")),document.querySelector("#Order-wrapper").style.zIndex="0"}));const c=function(e){e.stopPropagation()};window.addEventListener("keydown",(function(e){"Escape"!==e.key&&"Esc"!==e.key||null===o||(console.log("close modal"),i(e)),"Tab"!==e.key&&"ArrowDown"!==e.key&&"ArrowUp"!==e.key||null===o||function(e){e.preventDefault();let t=l.findIndex((e=>e===o.querySelector(":focus")));!0===e.shiftKey||"ArrowUp"===e.key?t--:t++,t>=l.length&&(t=0),t<0&&(t=l.length-1),l[t].focus()}(e)}))})()})).then((()=>{(async function(){var e,t;return r("div",{className:"sort"},[r("span",{id:"Order_by"},["Trier par"]),(e=r("button",{id:"sort_button",role:"button",ariaHashpopup:"listbox",ariaLabelledby:"Order_by sort_button",ariaExpanded:"false",className:"choose",value:"popularité"},[r("span",{className:"sortBy"},["Popularité"]),r("i",{className:"chevron fas fa-chevron-up",ariaHidden:"true"},void 0)]),t=r("ul",{id:"tri",role:"listbox",ariaLabelledby:"Order_by",tabIndex:"-1",style:"display: none"},[r("li",{id:"pop",className:"choose",role:"option"},["Popularité"]),r("li",{className:"chevronRotate"},[r("i",{className:"chevron fas fa-chevron-up",ariaHidden:"true"},void 0)]),r("li",{className:"dropdown-divider",role:"separator",tabIndex:"-1"},void 0),r("li",{id:"titre",className:"choose",role:"option"},["Titre"]),r("li",{className:"dropdown-divider",role:"separator",tabIndex:"-1"},void 0),r("li",{id:"date",className:"choose",role:"option"},["Date"])]),r("div",{id:"Order-wrapper"},[e,t]))])})().then((e=>{let t=a(e);document.querySelector(".wrapper").insertAdjacentElement("beforeend",t)})).then((()=>{(async()=>{const e=document.getElementById("sort_button");let t=0,n=null,o=[];const a=function(t){null===n&&(n=document.getElementById("tri"),e.setAttribute("aria-expanded",!0),o=Array.from(document.querySelectorAll("li.choose")),o[0].focus(),o[0].classList.add("buttonSortClicked"),o[0].setAttribute("aria-selected",!0),n.style.display=null,n.querySelector(".chevronRotate").classList.add("activateRotate"),document.getElementById("Order-wrapper").addEventListener("click",i),o.forEach((t=>t.addEventListener("click",(function(){t.setAttribute("aria-selected",!0),e.value=t.innerText.trim(),e.querySelector("span").innerText=t.innerText.trim(),console.log("cliqué sur les LI pour et ça a close"),r()})))),document.addEventListener("click",r))};async function r(){if(null==n)return;e.removeEventListener("click",r),document.getElementById("Order-wrapper").removeEventListener("click",i),document.removeEventListener("click",r),e.setAttribute("aria-expanded",!1),n.style.display="none",e.focus(),o[t].classList.remove("buttonSortClicked"),n.querySelector(".chevronRotate").classList.remove("activateRotate");let a=document.querySelector(".sectioncontainer"),c=await S(e.value);console.log(c),l(a,c),k(),g(),n=null}e.addEventListener("click",(()=>{console.log("bouton openmenu"),a()}));const i=function(e){console.log("arrête de te propager"),e.stopPropagation()};window.addEventListener("keydown",(function(a){"Tab"===a.key&&null!==n&&(console.log("tab close"),r()),"Escape"!==a.key&&"Esc"!==a.key||(console.log("escape"),r()),"ArrowDown"!==a.key&&"ArrowUp"!==a.key||null===n||function(a){a.preventDefault(),o[0].classList.remove("buttonSortClicked"),o[t].setAttribute("aria-selected",!1),o[t].classList.remove("buttonSortClicked"),console.log(t),!0===a.shiftKey||"ArrowUp"===a.key?t--:t++,t>=o.length&&(t=0),t<0&&(t=o.length-1),console.log(t),console.log(o[t]),o[t].focus(),o[t].setAttribute("aria-selected",!0),e.setAttribute("value",o[t].innerText.trim()),e.querySelector("span").innerText=o[t].innerText.trim(),n.setAttribute("aria-activedescendant",o[t].id),o[t].classList.add("buttonSortClicked")}(a)})),window.addEventListener("keydown",(function(e){"Enter"===e.key&&null!==n&&r()})),e.addEventListener("keydown",(function(e){"ArrowDown"!==e.key&&"ArrowUp"!==e.key||null!=n||a()}))})()}))})).then((()=>{S().then((e=>{console.log(e);let t=a(e);document.querySelector(".wrapper").insertAdjacentElement("beforeEnd",t),k()}))})).then((()=>{(async function(){return r("div",{className:"likesContainer"},[r("div",{className:"totalLikes"},[r("p",{className:"totalLikes--number"},void 0),r("p",{className:"totalLikes--heart"},[r("img",{src:"./images/heart.svg"},void 0)])]),r("div",{className:"salaire"},[r("p",{className:"salaire--journalier"},void 0)])])})().then((e=>{let t=a(e);document.querySelector(".wrapper").insertAdjacentElement("beforeEnd",t)})).then((()=>{g()}))}))}():(window.location.search="",history.pushState({},null,"index.html"),P())})();